<script>
  
    //   default values
    let currentUser = null;


  // DOM elements
  const loginForm = document.getElementById("login-form");
  const eidInput = document.getElementById("eid-input");
  const loginButton = document.getElementById("login-button");
  const eidAlert = document.getElementById("eid-alert");

  eidInput.addEventListener("input", (e) => {
    // Remove non-digit characters immediately
    eidInput.value = eidInput.value.replace(/\D/g, "");

    const isValid = /^\d{7}$/.test(eidInput.value); // exactly 7 digits
    loginButton.disabled = !isValid;
  });

  eidInput.addEventListener("paste", (e) => {
    e.preventDefault();
    const text = (e.clipboardData || window.clipboardData).getData("text");
    eidInput.value = text.replace(/\D/g, "").slice(0, 7);
  });

  loginForm.addEventListener("submit", function(e){
    e.preventDefault();
    const eid = eidInput.value;

    google.script.run
        .withSuccessHandler(function(result){
            if (result.success){
                currentUser = result.user;
                sessionStorage.setItem("calPromptUser", JSON.stringify(currentUser))
            } else {
                eidAlert.classList.remove("hidden");
            }
        }).validateEid(eid);
        console.log(currentUser)
        console.log("login successful")


})

</script>
